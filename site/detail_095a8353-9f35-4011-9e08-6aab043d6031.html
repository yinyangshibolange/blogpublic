<!DOCTYPE html>
<html>

<head><meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<script src="/js/jquery.min.js"></script>
<script src="/js/common.js"></script>
<link rel="stylesheet" href="/css/common.css">
<link rel="stylesheet" href="/vnocss/vno.css">
    <meta charset="utf-8">
    <title>Beacon</title>
    <meta name="description" content="Beacon
è¿™ä¸ªapiå¯ä»¥è®©åœ¨é¡µé¢å…³é—­æ—¶ï¼Œå‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œç”±äºä¼ ç»Ÿçš„xhrè¯·æ±‚ä¸å¯é ï¼Œä¸èƒ½ä¿è¯å‘é€æˆåŠŸï¼Œæ‰€ä»¥è¯ç”Ÿäº†è¿™ä¸ªapiï¼Œè¿™åœ¨æŸäº›ç‰¹æ®Šåœºæ™¯ä¸‹å°†ä¼šæ¯”è¾ƒå®ç”¨
é£Ÿç”¨æ–¹æ³•å¦‚ä¸‹ï¼š
navigator">
    <meta name="keywords" content="">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/modules/preview.css">
    <link rel="stylesheet" href="/css/markdown.css">
    <link rel="stylesheet" href="/css/modules/detail.css">
    
</head>

<body><div id="app">
    <div id="container" class="container">


        <a onclick="showMenu()" class="menu-trigger-btn">
    <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24"><path fill="#333" d="M19 17H5c-1.103 0-2 .897-2 2s.897 2 2 2h14c1.103 0 2-.897 2-2s-.897-2-2-2m0-7H5c-1.103 0-2 .897-2 2s.897 2 2 2h14c1.103 0 2-.897 2-2s-.897-2-2-2m0-7H5c-1.103 0-2 .897-2 2s.897 2 2 2h14c1.103 0 2-.897 2-2s-.897-2-2-2"/></svg>
</a>
<script>
function showMenu() {
    $('.container-left').addClass("show")
    $('.container-left-mask').addClass("show")

    $("body").css("overflow", "hidden")
}
function hideMenu() {
    $('.container-left').removeClass("show")
    $('.container-left-mask').removeClass("show")

    $("body").css("overflow", "auto")
}
</script>
<div class="container-left-mask" onclick="hideMenu()"></div>
<div class="container-left">
    <a class="head-info" href="/index.html">
        <!-- <img src="" alt="" class="header-banner"> -->
        <div class="header-title color-333">å¼ çˆ±ä¸Šäº†hong</div>
        <div class="header-desp color-999">ğŸºçˆ±ä¸Šäº†ğŸ‘</div>
    </a>
    <ul id="menusUl" class="menus-ul">
        <li>
            <a href="/index.html">é¦–é¡µ</a>
        </li>

        
            <li>
                <a href="/site/categorys.html">æ‰€æœ‰åˆ†ç±»</a>
            </li>
            
            <li>
                <a href="/site/tags.html">æ ‡ç­¾äº‘</a>
            </li>
            
            <li>
                <a href="/site/about.html">å…³äº</a>
            </li>
            

                <script>
                    $("#menusUl > li > a").removeClass("active").each((index, el) =>  {
                        if($(el).attr("href") === window.location.pathname) {
                            $(el).addClass("active")
                        }
                    })
                </script>
    </ul>
</div>

            <div class="container-content">
                <div>
                    <h1 class="preview-title mb-5px">
                        Beacon
                    </h1>

                </div>

                <div class="mb-20px ">
                    <div class="type"><!--åˆ†ç±»-->
                        åˆ†ç±»ï¼š<a href="/site/type_mdn.html">mdn</a>
                    </div>
                    <div class="flex justify-between align-center">
                        <div class="author "><!--ä½œè€…-->
                            ä½œè€…ï¼šhongyu
                        </div>
                        <div class="publish_time "><!--å‘å¸ƒæ—¶é—´-->
                            2024-06-13 09:53:04
                        </div>
                    </div>
                </div>

                <div class="preview-content markdown-body">
                    <h1>Beacon</h1>
<p>è¿™ä¸ªapiå¯ä»¥è®©åœ¨é¡µé¢å…³é—­æ—¶ï¼Œå‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œç”±äºä¼ ç»Ÿçš„xhrè¯·æ±‚ä¸å¯é ï¼Œä¸èƒ½ä¿è¯å‘é€æˆåŠŸï¼Œæ‰€ä»¥è¯ç”Ÿäº†è¿™ä¸ªapiï¼Œè¿™åœ¨æŸäº›ç‰¹æ®Šåœºæ™¯ä¸‹å°†ä¼šæ¯”è¾ƒå®ç”¨</p>
<p>é£Ÿç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="language-javascript">navigator.sendBeacon(url);
navigator.sendBeacon(url, data);
</code></pre>
<p><code>data</code>Â å¯ä»¥æ˜¯Â ArrayBufferã€ArrayBufferViewã€Blobã€DOMStringã€FormDataæˆ–Â URLSearchParamsÂ ç±»å‹çš„æ•°æ®ï¼Œæ•°æ®æ˜¯é€šè¿‡postè¯·æ±‚å‘é€çš„</p>
<p>æ³¨æ„è¿™ä¸ªapiä¸èƒ½å†unloadå’ŒbeforeUnloadä¸­ä½¿ç”¨ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªapiåœ¨ç¼“å­˜é¡µé¢å…³é—­æ—¶å¹¶ä¸ä¼šè§¦å‘ï¼Œåªæœ‰å½“ç¼“å­˜ä¹Ÿé”€æ¯çš„æ—¶å€™æ‰ä¼šè§¦å‘ï¼Œå…·ä½“æŸ¥çœ‹bfcacheæœºåˆ¶ï¼Œæ¯”å¦‚åœ¨é¡µé¢å‰è¿›æ—¶ï¼Œå½“å‰é¡µé¢æœªé”€æ¯ï¼Œè€Œæ˜¯ç¼“å­˜ä¸‹æ¥çš„æ—¶å€™ï¼Œå°±ä¸ä¼šè§¦å‘è¿™ä¸¤ä¸ªapiã€‚</p>
<p>æ‰€ä»¥è¿˜æ˜¯è¦çœ‹onpagehideå’Œvisibilitychangeè¿™ä¸¤ä¸ªapiï¼Œè€Œvisibilitychange</p>
<ul>
<li>visibilitychangeå½“é¡µé¢éšè—å’Œæ˜¾ç¤ºæ—¶è§¦å‘ï¼Œä¸”å½“ visibleStateState å±æ€§çš„å€¼è½¬æ¢ä¸ºÂ hiddenÂ æ—¶ï¼ŒSafari ä¸ä¼šæŒ‰é¢„æœŸè§¦å‘Â visibilitychangeã€‚</li>
<li>onpagehideå½“é¡µé¢éšè—å’Œæ˜¾ç¤ºæ—¶ä¸è§¦å‘ï¼Œåœ¨å½“å‰é¡µé¢ç¦»å¼€å‰å¾€å…¶ä»–é¡µé¢çš„æ—¶å€™è§¦å‘ï¼Œä¸”æœ‰ä¸€ä¸ªpersistedå‚æ•°ï¼Œè¡¨ç¤ºæ˜¯å¦ä»ç¼“å­˜ä¸­è·å–çš„</li>
</ul>
<p>html demoå¯ä»¥åˆ°æˆ‘çš„giteeä»“åº“ä¸‹è·å–
&lt;<a href="https://gitee.com/mrhki/web-api-demo.git">https://gitee.com/mrhki/web-api-demo.git</a>&gt;
éœ€è¦æ‰“å¼€serverä¸‹çš„koaæœåŠ¡å™¨ï¼Œå†æ‰“å¼€Beacon demoè¿è¡Œanywhere</p>

                </div>

                <div class="tags font-16px color-999 mt-10px"><!--ç§’é€Ÿ-->
                    
                        
                                
                </div>
                <div id="comments" class="container-comments mt-20px">

                </div>
            </div>



    </div>

    <!-- <script src="/js/jquery_dom.js"></script> -->
    <script src='/plugins/valine/Valine.min.js'></script>

    <script>
        async function copyCode () {
            try {
                var code = $(event.target).closest("pre").children("code").text()
                await navigator.clipboard.writeText(code)
                // showMessage('1', 'å¤åˆ¶æˆåŠŸ')
                // console.log('copy successed!' )
                // console.dir($(event.target))
                // console.log($(event.target).text())
                // $(event.target).text("copy successed!")
            } catch (err) {
                // showMessage('0', err.message)
            }
        }
        $(".markdown-body pre ").each((index, el) => {
            $(el).append($(`
                <a class="pre-code-copy" onclick="copyCode()">copy</a>
            `))
        })



        new Valine({
            el: '#comments',
            appId: 'uz55qcFlXoLnmXaKik9HqQgI-gzGzoHsz',
            appKey: 'AskBsksyQH7muT66he8uFG0V',
            placeholder: "ä½ æ˜¯æˆ‘ä¸€ç”Ÿåªä¼šé‡è§ä¸€æ¬¡çš„æƒŠå–œ ...",
            avatar: '',//å°æ€ªç‰©å¤´åƒ,
            visitor: true // é˜…è¯»é‡ç»Ÿ
        })
    </script>
</div></body>

</html>